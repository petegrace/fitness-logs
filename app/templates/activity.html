{% extends "base.html" %}

{% block styles %}
	{{ super() }}
    <link href="http://cdn.pydata.org/bokeh/release/bokeh-0.12.5.min.css" rel="stylesheet" />
    <link href="http://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.0.min.css" rel="stylesheet" />
{% endblock %}

{% block scripts %}
	{{ super() }}

	<script>
		$("#activity-nav").addClass("active");
	</script>
	<script src="http://cdn.pydata.org/bokeh/release/bokeh-0.13.0.min.js"></script>
    <script src="http://cdn.pydata.org/bokeh/release/bokeh-widgets-0.13.0.min.js"></script>
    {{ plot_by_day_script|safe }}
{% endblock %}

{% block app_content %}
	<h2>Activity</h2>
	<h5>Completed Exercise Sets by Day</h5>
	{{ plot_by_day_div|safe }}

	<ul class="nav nav-tabs mt-4">
		<li class="nav-item">
			<a class="nav-link {% if mode == 'summary' %} active {% endif %}" href="{{ url_for('activity', mode='summary') }}">Summary</a>
		</li>
		<li class="nav-item">
			<a class="nav-link {% if mode == 'detail' %} active {% endif %}" href="{{ url_for('activity', mode='detail') }}">Detail</a>
		</li>
	</ul>

	{% for exercise_date_group in exercises|groupby("exercise_date")|reverse %}
		<h5>{{ moment(exercise_date_group.grouper).format("ddd LL") }}:
			{{ exercise_date_group.list|length }} {% if mode == 'detail' %} sets of {% endif %} exercises</h5>
		<table class="table table-sm table-hover">
			{% if mode == "summary" %}
				{% for exercise in exercise_date_group.list %}
					<tr>
						<td style="width: 70%">{{ exercise.name }}</td>
						<td style="width: 30%">
							{% if exercise.measured_by == "reps" %}
								{{ exercise.total_reps }} reps
							{% elif exercise.measured_by == "seconds" %}
								{{ exercise.total_seconds }} secs
							{% endif %}
						</td>
					</tr>
				{% endfor %}
			{% elif mode == "detail" %}
				{% for exercise in exercise_date_group.list %}
					<tr>
						<td style="width: 50%">
							{% if exercise.scheduled_exercise %}
								<i class="fa fa-check-square-o"></i>
							{% endif %}
							{{ exercise.type.name }}
						</td>
						<td style="width: 15%">{{ moment(exercise.exercise_datetime).format("HH:mm:ss") }}</td>
						<td style="width: 20%">
							{% if exercise.type.measured_by == "reps" %}
								{{ exercise.reps }} reps
							{% elif exercise.type.measured_by == "seconds" %}
								{{ exercise.seconds }} secs
							{% endif %}
						</td>
						<td style="width: 15%"><a href="{{ url_for('edit_exercise', id=exercise.id, next='/activity/{mode}'.format(mode=mode)) }}"><i class="fa fa-edit"></i> Edit</a></td>
					</tr>
				{% endfor %}
			{% endif %}
		</table>

	{% endfor %}
{% endblock %}