{% extends "base.html" %}

{% block scripts %}
	{{ super() }}

	<script>
		$("#home-nav").addClass("active");
	</script>
{% endblock %}

{% block app_content %}
	<!-- TODO: Make this more relevant to the user depending where they are in user journey and give them option to dismiss for rest of session and/or permanently -->
	<div class="alert alert-success alert-dismissible fade show" role="alert">
		<h4>Take the Tour
			<!-- TODO: Re-enable this once it can act as a proper dismiss option rather than keep on coming back! -->
			<!--<button type="button" class="close" data-dismiss="alert" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>-->
		</h4>
		<p>Need some help getting started? Choose the guide for what you want to do...</p>
		<ol>
			<li>
				<a href="#" class="alert-link" data-toggle="modal" data-target="#howToLogExerciseModal">How to log exercises</a>
			</li>
			<li>
				<a href="#" class="alert-link" data-toggle="modal" data-target="#howToAnalyseCadenceModal">How to analyse your running cadence</a>	
			</li>
			<li>
				<a href="#" class="alert-link" data-toggle="modal" data-target="#howToCategoriseExercisesModal">How to categorise your exercises</a>	
			</li>
		</ol>
	</div>
	{% if recent_activities|length > 0 %}
		<div class="row align-items-end">
			<div class="col-md">
				<h3>Recently added activity</h3>
			</div>
			<div class="col-md">
				<nav>
					<ul class="pagination-sm nav justify-content-end ml-auto mb-2">					
			 			<li class="page-item {% if not prev_url %}disabled{% endif %}">
			 				<a class="page-link" href="{{ prev_url }}">Newer</a>
			 			</li>
			 			<li class="page-item {% if not next_url %}disabled{% endif %}">
			 				<a class="page-link" href="{{ next_url }}">Older</a>
			 			</li>
					</ul>
				</nav>
		 	</div>
	 	</div>		
	{% endif %}
	<table class="table table-sm table-hover">
		{% for activity in recent_activities %}
			<tr>
				<td>{{ moment(activity.created_datetime).calendar() }}</td>
				<td>
					{% if activity.scheduled_exercise_id %}
						<i class="fa fa-check-square-o"></i>
					{% elif activity.is_race %}
						<i class="fa fa-flag-checkered"></i>
					{% endif %}
					{% if activity.source == "Strava" %}
						<a href="{{ url_for('activity_analysis', id=activity.id) }}">{{ activity.name }}</a>
					{% else %}
						{{ activity.name }}
					{% endif %}
				</td>
				<td>
					{% if activity.measured_by == "reps" %}
						{{ activity.reps }} reps
					{% elif activity.measured_by == "seconds" %}
						{{ activity.seconds }} secs
					{% elif activity.measured_by == "distance" %}
						{{ utils.convert_m_to_km(activity.distance) }} km
					{% endif %}
				</td>
				<td>
					{% if activity.source == "Exercise" %}
						<a href="{{ url_for('edit_exercise', id=activity.id) }}"><i class="fa fa-edit"></i> Edit</a>
					{% elif activity.source == "Strava" %}
						<a href="https://www.strava.com/activities/{{ activity.external_id }}">View on Strava</a>
					{% endif %}
				</td>
			</tr>
		{% endfor %}
	</table>

	{% if scheduled_exercises or has_completed_schedule %}
		<div class="card">
			<div class="card-header">
				<h4>Log exercises from Training Plan</h4>
			</div>
			<div class="card-body exercise-buttons">
				{% if has_completed_schedule %}
					<div class="alert alert-success">
						<i class="fa fa-check-square-o fa-lg"></i> Great work! You've ticked off your planned exercises for today!
					</div>
				{% endif %}
				{% for scheduled_exercise in scheduled_exercises %}
					<a class="btn btn-sm
					{% if scheduled_exercise.category_key is none %}
						btn-outline-secondary
					{% elif scheduled_exercise.category_key == 'cat_green' %}
						btn-success
					{% elif scheduled_exercise.category_key == 'cat_green_outline' %}
						btn-outline-success
					{% elif scheduled_exercise.category_key == 'cat_blue' %}
						btn-primary
					{% elif scheduled_exercise.category_key == 'cat_blue_outline' %}
						btn-outline-primary
					{% elif scheduled_exercise.category_key == 'cat_red' %}
						btn-danger
					{% elif scheduled_exercise.category_key == 'cat_red_outline' %}
						btn-outline-danger
					{% elif scheduled_exercise.category_key == 'cat_yellow' %}
						btn-warning
					{% elif scheduled_exercise.category_key == 'cat_yellow_outline' %}
						btn-outline-warning
					{% endif %}
					" role="button" href="{{ url_for('log_exercise', scheduled='scheduled', id=scheduled_exercise.id) }}">
						<i class="fa fa-check-square-o"></i> {{ scheduled_exercise.name }}
						<br />
						<small>
							{% if scheduled_exercise.measured_by == "reps" %}
								[{{ scheduled_exercise.reps }} reps]
							{% elif scheduled_exercise.measured_by == "seconds" %}
								[{{ scheduled_exercise.seconds }} secs]
							{% endif %}
							<br />
							{{ (scheduled_exercise.sets - scheduled_exercise.completed_sets) }} sets to do
						</small>
					</a>
				{% endfor %}
			</div>
		</div>
	{% endif %}

	<div class="card mt-2">
			<div class="card-header">
				<h4>Import new activities from Strava</h4>
			</div>
			<div class="card-body exercise-buttons">
				<a href="{{ url_for('connect_strava', action='authorize') }}"><img src="/static/img/btn_strava_connectwith_orange.png" /></a>
			</div>
		</div>

	<div class="card mt-2">
		<div class="card-header">
			<h4>Log {% if scheduled_exercises or has_completed_schedule %}adhoc{% endif %} exercises</h4>
		</div>
		<div class="card-body exercise-buttons">
			<a class="btn btn-secondary btn-sm" role="button" href="{{ url_for('new_exercise', context="logging") }}">
				<i class="fa fa-check"></i> New Exercise Type
				<br /><small>&nbsp;</small>
			</a>
			{% for exercise_type in exercise_types %}
				<a class="btn btn-sm
				{% if exercise_type.category_key is none %}
					btn-outline-secondary
				{% elif exercise_type.category_key == 'cat_green' %}
					btn-success
				{% elif exercise_type.category_key == 'cat_green_outline' %}
					btn-outline-success
				{% elif exercise_type.category_key == 'cat_blue' %}
					btn-primary
				{% elif exercise_type.category_key == 'cat_blue_outline' %}
					btn-outline-primary
				{% elif exercise_type.category_key == 'cat_red' %}
					btn-danger
				{% elif exercise_type.category_key == 'cat_red_outline' %}
					btn-outline-danger
				{% elif exercise_type.category_key == 'cat_yellow' %}
					btn-warning
				{% elif exercise_type.category_key == 'cat_yellow_outline' %}
					btn-outline-warning
				{% endif %}
				" role="button" href="{{ url_for('log_exercise', scheduled='other', id=exercise_type.id) }}">
					<i class="fa fa-check"></i> {{ exercise_type.name }}
					<br />
					<small>
						{% if exercise_type.measured_by == "reps" %}
							[{{ exercise_type.default_reps }} reps]
						{% elif exercise_type.measured_by == "seconds" %}
							[{{ exercise_type.default_seconds }} secs]
						{% endif %}
					</small>
				</a>
			{% endfor %}
		</div>
	</div>

	<!-- Modal and carousel for how to log exercise -->
	<div class="modal fade" id="howToLogExerciseModal" tabindex="-1" role="dialog" aria-labelledby="howToLogExerciseModalLabel" aria-hidden="true">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="howToLogExerciseModalLabel">How to log exercises</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
	        <div id="howToLogExerciseCarouselIndicators" class="carousel slide" >
			  <ol class="carousel-indicators">
			    <li data-target="#howToLogExerciseCarouselIndicators" data-slide-to="0" class="active"></li>
			    <li data-target="#howToLogExerciseCarouselIndicators" data-slide-to="1"></li>
			    <li data-target="#howToLogExerciseCarouselIndicators" data-slide-to="2"></li>
			    <li data-target="#howToLogExerciseCarouselIndicators" data-slide-to="3"></li>
			    <li data-target="#howToLogExerciseCarouselIndicators" data-slide-to="4"></li>
			  </ol>
			  <div class="carousel-inner">
			    <div class="carousel-item mb-5 active">
			      <img class="d-block w-100" src="/static/img/how_to_log_exercise_step_1.jpg" alt="Step 1">
			      <hr class="featurette-divider" />
			      <p><small>First of all you need to do some work, so choose your favourite exercise and do some reps! Once you're done click the <strong>New Exercise Type</strong> button.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_log_exercise_step_2.jpg" alt="Step 2">
			      <hr class="featurette-divider" />
			      <p><small>Enter a name for the exercise you’ve just done and specify how many reps you did. Or if you chose exercise that involves holding a position then change the <strong>Measured By</strong> dropdown to “Time (seconds)” and enter the number of seconds in the field below. Once you’re done click <strong>Log Exercise</strong>.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_log_exercise_step_3.jpg" alt="Step 3">
			      <hr class="featurette-divider" />
			      <p><small>Your exercise will now show up under <strong>Recently added activity</strong>. Whilst you’re in the mood, why not repeat the exercise you’ve just done? This time once you’re done, click the new button that’s appeared for your exercise.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_log_exercise_step_4.jpg" alt="Step 4">
			      <hr class="featurette-divider" />
			      <p><small>You’ll notice that the button defaults to logging the same number of reps that you did first time round, so if you do a different number just click the <strong>Edit</strong> link after you’ve recorded the exercise.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_log_exercise_step_5.jpg" alt="Step 5">
			      <hr class="featurette-divider" />
			      <p><small>If you want to change the default number of reps then just tick the <strong>Update default</strong> tickbox and this in turn will update the button once you click on <strong>Update Exercise</strong>.</small></p>
			    </div>
			  </div>
			  <a class="carousel-control-prev" href="#howToLogExerciseCarouselIndicators" role="button" data-slide="prev">
			    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
			    <span class="sr-only">Previous</span>
			  </a>
			  <a class="carousel-control-next" href="#howToLogExerciseCarouselIndicators" role="button" data-slide="next">
			    <span class="carousel-control-next-icon" aria-hidden="true"></span>
			    <span class="sr-only">Next</span>
			  </a>
			</div>
	      </div>
	    </div>
	  </div>
	</div>

	<!-- Modal and carousel for how to analyse cadence -->
	<div class="modal fade" id="howToAnalyseCadenceModal" tabindex="-1" role="dialog" aria-labelledby="howToAnalyseCadenceModalLabel" aria-hidden="true">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="howToAnalyseCadenceModalLabel">How to analyse your running cadence</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
	        <div id="howToAnalyseCadenceCarouselIndicators" class="carousel slide" >
			  <ol class="carousel-indicators">
			    <li data-target="#howToAnalyseCadenceCarouselIndicators" data-slide-to="0" class="active"></li>
			    <li data-target="#howToAnalyseCadenceCarouselIndicators" data-slide-to="1"></li>
			    <li data-target="#howToAnalyseCadenceCarouselIndicators" data-slide-to="2"></li>
			    <li data-target="#howToAnalyseCadenceCarouselIndicators" data-slide-to="3"></li>
			    <li data-target="#howToAnalyseCadenceCarouselIndicators" data-slide-to="4"></li>
			    <li data-target="#howToAnalyseCadenceCarouselIndicators" data-slide-to="5"></li>
			    <li data-target="#howToAnalyseCadenceCarouselIndicators" data-slide-to="6"></li>
			  </ol>
			  <div class="carousel-inner">
			    <div class="carousel-item mb-5 active">
			      <img class="d-block w-100" src="/static/img/how_to_analyse_cadence_step_1.jpg" alt="Step 1">
			      <hr class="featurette-divider" />
			      <p><small>Training Ticks gives you tools to understand your natural cadence (steps per minute) and target improvement, as well as measure your interval training. If you haven’t already, start by importing your runs using <strong>Connect With Strava</strong>.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_analyse_cadence_step_2.jpg" alt="Step 2">
			      <hr class="featurette-divider" />
			      <p><small>Now click on any of your running activities to open up more detail including the cadence data. You can do this from under <strong>Recently added activity</strong>, or hop along to <strong>Analysis & Goals</strong> from the menu at the top to navigate by week.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_analyse_cadence_step_3.jpg" alt="Step 3">
			      <hr class="featurette-divider" />
			      <p><small>The first time you open an activity in Training Ticks it will connect to Strava again to retrieve more detailed cadence data, and present you with 2 charts to visualise how much time you spent at any given cadence (in steps per minute), and how much time you spent in total above any given cadence.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_analyse_cadence_step_4.jpg" alt="Step 4">
			      <hr class="featurette-divider" />
			      <p><small>Cadence analysis gives you a great way to measure your interval training, where you'll typically see two peaks on the left chart - one for intervals and another for your normal/recovery pace. From the chart on the right you can easily see how much time you spent doing intervals and at what cadence.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_analyse_cadence_step_5.jpg" alt="Step 5">
			      <hr class="featurette-divider" />
			      <p><small>If you make your way to <strong>Analysis & Goals</strong> from the menu at the top you can see your cumulative cadence stats across each week by clicking on the tab for <strong>Time Spent Above Cadence</strong>. Note that you must have viewed the activities for that week first in order to process the cadence data.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_analyse_cadence_step_6.jpg" alt="Step 6">
			      <hr class="featurette-divider" />
			      <p><small>You might be wondering why the charts are all in a rather dull dark grey! You can fix that easily by going to <strong>Manage Exercises</strong> from the top menu and then clicking on the <strong>Exercise Categories</strong> tab. Choose your favourite colour from those available, and type in "Run", then click the <strong>Save Changes</strong> button.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_analyse_cadence_step_7.jpg" alt="Step 7">
			      <hr class="featurette-divider" />
			      <p><small>Now go back to the <strong>Analysis & Goals</strong> page, or one of your activities, and admire the much prettier graphs!</small></p>
			    </div>
			  </div>
			  <a class="carousel-control-prev" href="#howToAnalyseCadenceCarouselIndicators" role="button" data-slide="prev">
			    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
			    <span class="sr-only">Previous</span>
			  </a>
			  <a class="carousel-control-next" href="#howToAnalyseCadenceCarouselIndicators" role="button" data-slide="next">
			    <span class="carousel-control-next-icon" aria-hidden="true"></span>
			    <span class="sr-only">Next</span>
			  </a>
			</div>
	      </div>
	    </div>
	  </div>
	</div>

	<!-- Modal and carousel for how to categorise your exercises -->
	<div class="modal fade" id="howToCategoriseExercisesModal" tabindex="-1" role="dialog" aria-labelledby="howToCategoriseExercisesModalLabel" aria-hidden="true">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="howToCategoriseExercisesModalLabel">How to categorise your exercises</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
	        <div id="howToCategoriseExercisesCarouselIndicators" class="carousel slide" >
			  <ol class="carousel-indicators">
			    <li data-target="#howToCategoriseExercisesCarouselIndicators" data-slide-to="0" class="active"></li>
			    <li data-target="#howToCategoriseExercisesCarouselIndicators" data-slide-to="1"></li>
			    <li data-target="#howToCategoriseExercisesCarouselIndicators" data-slide-to="2"></li>
			    <li data-target="#howToCategoriseExercisesCarouselIndicators" data-slide-to="3"></li>
			    <li data-target="#howToCategoriseExercisesCarouselIndicators" data-slide-to="4"></li>
			    <li data-target="#howToCategoriseExercisesCarouselIndicators" data-slide-to="5"></li>
			    <li data-target="#howToCategoriseExercisesCarouselIndicators" data-slide-to="6"></li>
			  </ol>
			  <div class="carousel-inner">
			    <div class="carousel-item mb-5 active">
			      <img class="d-block w-100" src="/static/img/how_to_categorise_exercises_step_1.jpg" alt="Step 1">
			      <hr class="featurette-divider" />
			      <p><small>Exercise categories enable you to customise the Training Ticks user interface for the way that you think about your training. So for example I might want to classify Calf raises and Press ups in the screenshot above as "Strength" exercises, and Calf stretch as a "Stretch" exercise. Training Ticks doesn't prescribe any categories by default, which means that until you set up any categories everything will have a rather dull and grey look. Let's change that!</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_categorise_exercises_step_2.jpg" alt="Step 2">
			      <hr class="featurette-divider" />
			      <p><small>Go to the menu at the top and select <strong>Manage Exercises</strong>. The first tab it loads up enables you to edit the exercises types themselves, so click on the next tab along for <strong>Exercise Categories</strong>.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_categorise_exercises_step_3.jpg" alt="Step 3">
			      <hr class="featurette-divider" />
			      <p><small>Training Ticks currently allows you to set up to 8 categories - 4 based on filled colours and 4 based on an outline border. For this example I've decided to use the solid blue category for "Strength" and the outine blue category for "Stretch".</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_categorise_exercises_step_4.jpg" alt="Step 4">
			      <hr class="featurette-divider" />
			      <p><small>Any exercises you've created up to now will remain uncategorised until we edit them, so hop back to the <strong>Exercise Types</strong> tab and click the <strong>Edit</strong> link next to each of your exercises.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_categorise_exercises_step_5.jpg" alt="Step 5">
			      <hr class="featurette-divider" />
			      <p><small>Now that you're using categories you'll see a drop down menu allowing you to choose the relevant one for each exercise, so set this to the value you want and click <strong>Update Exercise Type</strong>.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_categorise_exercises_step_6.jpg" alt="Step 6">
			      <hr class="featurette-divider" />
			      <p><small>Once you've updated your exercise types, return to the home page and check out the buttons that should now be colour-coded according to the changes you've just made. Next time you log a New Exercise Type the category option will be available immediately.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_categorise_exercises_step_7.jpg" alt="Step 7">
			      <hr class="featurette-divider" />
			      <p><small>The same colour-coding scheme will be used across the rest of the Training Ticks user interface, so for example if you pop along to the <strong>Analysis & Goals</strong> page you'll see the charts now use your category colours, as does the summary for your weekly activity.</small></p>
			    </div>
			  </div>
			  <a class="carousel-control-prev" href="#howToCategoriseExercisesCarouselIndicators" role="button" data-slide="prev">
			    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
			    <span class="sr-only">Previous</span>
			  </a>
			  <a class="carousel-control-next" href="#howToCategoriseExercisesCarouselIndicators" role="button" data-slide="next">
			    <span class="carousel-control-next-icon" aria-hidden="true"></span>
			    <span class="sr-only">Next</span>
			  </a>
			</div>
	      </div>
	    </div>
	  </div>
	</div>
{% endblock %}