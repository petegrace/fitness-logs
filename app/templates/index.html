{% extends "base.html" %}

{% block scripts %}
	{{ super() }}

	<script>
		$("#home-nav").addClass("active");
	</script>
{% endblock %}

{% block app_content %}
	{% if recent_activities|length < 5 %}
		<h3>Need some help getting started?</h3>
		<a href="#" data-toggle="modal" data-target="#howToLogExerciseModal">Take the tour on how to log exercises</a>		
	{% endif %}
	{% if recent_activities|length > 0 %}
		<div class="row align-items-end">
			<div class="col-md">
				<h3>Recently added activity</h3>
			</div>
			<div class="col-md">
				<nav>
					<ul class="pagination-sm nav justify-content-end ml-auto mb-2">					
			 			<li class="page-item {% if not prev_url %}disabled{% endif %}">
			 				<a class="page-link" href="{{ prev_url }}">Newer</a>
			 			</li>
			 			<li class="page-item {% if not next_url %}disabled{% endif %}">
			 				<a class="page-link" href="{{ next_url }}">Older</a>
			 			</li>
					</ul>
				</nav>
		 	</div>
	 	</div>		
	{% endif %}
	<table class="table table-sm table-hover">
		{% for activity in recent_activities %}
			<tr>
				<td>{{ moment(activity.created_datetime).calendar() }}</td>
				<td>
					{% if activity.scheduled_exercise_id %}
						<i class="fa fa-check-square-o"></i>
					{% elif activity.is_race %}
						<i class="fa fa-flag-checkered"></i>
					{% endif %}
					{% if activity.source == "Strava" %}
						<a href="{{ url_for('activity_analysis', id=activity.id) }}">{{ activity.name }}</a>
					{% else %}
						{{ activity.name }}
					{% endif %}
				</td>
				<td>
					{% if activity.measured_by == "reps" %}
						{{ activity.reps }} reps
					{% elif activity.measured_by == "seconds" %}
						{{ activity.seconds }} secs
					{% elif activity.measured_by == "distance" %}
						{{ utils.convert_m_to_km(activity.distance) }} km
					{% endif %}
				</td>
				<td>
					{% if activity.source == "Exercise" %}
						<a href="{{ url_for('edit_exercise', id=activity.id) }}"><i class="fa fa-edit"></i> Edit</a>
					{% elif activity.source == "Strava" %}
						<a href="https://www.strava.com/activities/{{ activity.external_id }}">View on Strava</a>
					{% endif %}
				</td>
			</tr>
		{% endfor %}
	</table>

	{% if scheduled_exercises or has_completed_schedule %}
		<div class="card">
			<div class="card-header">
				<h4>Log exercises from Training Plan</h4>
			</div>
			<div class="card-body exercise-buttons">
				{% if has_completed_schedule %}
					<div class="alert alert-success">
						<i class="fa fa-check-square-o fa-lg"></i> Great work! You've ticked off your planned exercises for today!
					</div>
				{% endif %}
				{% for scheduled_exercise in scheduled_exercises %}
					<a class="btn btn-sm
					{% if scheduled_exercise.category_key is none %}
						btn-outline-secondary
					{% elif scheduled_exercise.category_key == 'cat_green' %}
						btn-success
					{% elif scheduled_exercise.category_key == 'cat_green_outline' %}
						btn-outline-success
					{% elif scheduled_exercise.category_key == 'cat_blue' %}
						btn-primary
					{% elif scheduled_exercise.category_key == 'cat_blue_outline' %}
						btn-outline-primary
					{% elif scheduled_exercise.category_key == 'cat_red' %}
						btn-danger
					{% elif scheduled_exercise.category_key == 'cat_red_outline' %}
						btn-outline-danger
					{% elif scheduled_exercise.category_key == 'cat_yellow' %}
						btn-warning
					{% elif scheduled_exercise.category_key == 'cat_yellow_outline' %}
						btn-outline-warning
					{% endif %}
					" role="button" href="{{ url_for('log_exercise', scheduled='scheduled', id=scheduled_exercise.id) }}">
						<i class="fa fa-check-square-o"></i> {{ scheduled_exercise.name }}
						<br />
						<small>
							{% if scheduled_exercise.measured_by == "reps" %}
								[{{ scheduled_exercise.reps }} reps]
							{% elif scheduled_exercise.measured_by == "seconds" %}
								[{{ scheduled_exercise.seconds }} secs]
							{% endif %}
							<br />
							{{ (scheduled_exercise.sets - scheduled_exercise.completed_sets) }} sets to do
						</small>
					</a>
				{% endfor %}
			</div>
		</div>
	{% endif %}

	<div class="card mt-2">
			<div class="card-header">
				<h4>Import new activities from Strava</h4>
			</div>
			<div class="card-body exercise-buttons">
				<a href="{{ url_for('connect_strava', action='authorize') }}"><img src="/static/img/btn_strava_connectwith_orange.png" /></a>
			</div>
		</div>

	<div class="card mt-2">
		<div class="card-header">
			<h4>Log {% if scheduled_exercises or has_completed_schedule %}adhoc{% endif %} exercises</h4>
		</div>
		<div class="card-body exercise-buttons">
			<a class="btn btn-secondary btn-sm" role="button" href="{{ url_for('new_exercise', context="logging") }}">
				<i class="fa fa-check"></i> New Exercise Type
				<br /><small>&nbsp;</small>
			</a>
			{% for exercise_type in exercise_types %}
				<a class="btn btn-sm
				{% if exercise_type.category_key is none %}
					btn-outline-secondary
				{% elif exercise_type.category_key == 'cat_green' %}
					btn-success
				{% elif exercise_type.category_key == 'cat_green_outline' %}
					btn-outline-success
				{% elif exercise_type.category_key == 'cat_blue' %}
					btn-primary
				{% elif exercise_type.category_key == 'cat_blue_outline' %}
					btn-outline-primary
				{% elif exercise_type.category_key == 'cat_red' %}
					btn-danger
				{% elif exercise_type.category_key == 'cat_red_outline' %}
					btn-outline-danger
				{% elif exercise_type.category_key == 'cat_yellow' %}
					btn-warning
				{% elif exercise_type.category_key == 'cat_yellow_outline' %}
					btn-outline-warning
				{% endif %}
				" role="button" href="{{ url_for('log_exercise', scheduled='other', id=exercise_type.id) }}">
					<i class="fa fa-check"></i> {{ exercise_type.name }}
					<br />
					<small>
						{% if exercise_type.measured_by == "reps" %}
							[{{ exercise_type.default_reps }} reps]
						{% elif exercise_type.measured_by == "seconds" %}
							[{{ exercise_type.default_seconds }} secs]
						{% endif %}
					</small>
				</a>
			{% endfor %}
		</div>
	</div>

	<!-- Modal and carousel for how to guide -->
	<div class="modal fade" id="howToLogExerciseModal" tabindex="-1" role="dialog" aria-labelledby="howToLogExerciseModalLabel" aria-hidden="true">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <h5 class="modal-title" id="howToLogExerciseModalLabel">How to log exercises</h5>
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	          <span aria-hidden="true">&times;</span>
	        </button>
	      </div>
	      <div class="modal-body">
	        <div id="howToLogExerciseCarouselIndicators" class="carousel slide" >
			  <ol class="carousel-indicators">
			    <li data-target="#howToLogExerciseCarouselIndicators" data-slide-to="0" class="active"></li>
			    <li data-target="#howToLogExerciseCarouselIndicators" data-slide-to="1"></li>
			    <li data-target="#howToLogExerciseCarouselIndicators" data-slide-to="2"></li>
			    <li data-target="#howToLogExerciseCarouselIndicators" data-slide-to="3"></li>
			    <li data-target="#howToLogExerciseCarouselIndicators" data-slide-to="4"></li>
			  </ol>
			  <div class="carousel-inner">
			    <div class="carousel-item mb-5 active">
			      <img class="d-block w-100" src="/static/img/how_to_log_exercise_step_1.jpg" alt="Step 1">
			      <hr class="featurette-divider" />
			      <p><small>First of all you need to do some work, so choose your favourite exercise and do some reps! Once you're done click the <strong>New Exercise Type</strong> button.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_log_exercise_step_2.jpg" alt="Step 2">
			      <hr class="featurette-divider" />
			      <p><small>Enter a name for the exercise you’ve just done and specify how many reps you did. Or if you chose exercise that involves holding a position then change the <strong>Measured By</strong> dropdown to “Time (seconds)” and enter the number of seconds in the field below. Once you’re done click <strong>Log Exercise</strong>.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_log_exercise_step_3.jpg" alt="Step 3">
			      <p><small>Your exercise will now show up under <strong>Recently added activity</strong>. Whilst you’re in the mood, why not repeat the exercise you’ve just done? This time once you’re done, click the new button that’s appeared for your exercise.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_log_exercise_step_4.jpg" alt="Step 4">
			      <hr class="featurette-divider" />
			      <p><small>You’ll notice that the button defaults to logging the same number of reps that you did first time round, so if you do a different number just click the <strong>Edit</strong> link after you’ve recorded the exercise.</small></p>
			    </div>
			    <div class="carousel-item mb-5">
			      <img class="d-block w-100" src="/static/img/how_to_log_exercise_step_5.jpg" alt="Step 5">
			      <hr class="featurette-divider" />
			      <p><small>If you want to change the default number of reps then just tick the <strong>Update default</strong> tickbox and this in turn will update the button once you click on <strong>Update Exercise</strong>.</small></p>
			    </div>
			  </div>
			  <a class="carousel-control-prev" href="#howToLogExerciseCarouselIndicators" role="button" data-slide="prev">
			    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
			    <span class="sr-only">Previous</span>
			  </a>
			  <a class="carousel-control-next" href="#howToLogExerciseCarouselIndicators" role="button" data-slide="next">
			    <span class="carousel-control-next-icon" aria-hidden="true"></span>
			    <span class="sr-only">Next</span>
			  </a>
			</div>
	      </div>
	    </div>
	  </div>
	</div>
{% endblock %}