{% extends "base.html" %}

{% block styles %}
	{{ super() }}
    <link href="http://cdn.pydata.org/bokeh/release/bokeh-0.12.5.min.css" rel="stylesheet" />
    <link href="http://cdn.pydata.org/bokeh/release/bokeh-widgets-0.12.0.min.css" rel="stylesheet" />
{% endblock %}

{% block scripts %}
	{{ super() }}

	<script>
		$("#activity-nav").addClass("active");
	</script>
	<script src="http://cdn.pydata.org/bokeh/release/bokeh-0.13.0.min.js"></script>
	<script src="http://cdn.pydata.org/bokeh/release/bokeh-widgets-0.13.0.min.js"></script>
	{{ weekly_summary_plot_script|safe }}
{% endblock %}

{% block app_content %}
	<div class="card"><div class="card-body">
	<div class = "row">
		<div class="col-md">
			<div class="dropdown">
				<button class="btn btn-outline-primary dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown">
					Select Week
				</button>
				<div class="dropdown-menu dropdown-menu-scrollable">
					{% for week in week_options %}
						<a class="dropdown-item {% if week.calendar_week_start_date==current_week %}active{% endif %}" href="{{ url_for("weekly_activity", year=current_year, week=week.calendar_week_start_date) }}">{{ week.calendar_week_start_date }}</a>
					{% endfor %}
				</div>
			</div>
		</div>
		<div class="col-md">
			<nav class="">
				<ul class="pagination nav justify-content-end ml-auto">
					<li class="page-item">
				    	<a class="page-link" href="#">
							<span aria-hidden="true">&laquo;</span>
							<span class="sr-only">Previous</span>
				    	</a>
					</li>
					<li class="page-item"><a class="page-link" href="#">2015</a></li>
					<li class="page-item"><a class="page-link" href="#">2016</a></li>
					<li class="page-item"><a class="page-link" href="#">2017</a></li>
					<li class="page-item active"><a class="page-link" href="#">2018</a></li>
					<li class="page-item disabled">
						<a class="page-link" href="#" aria-label="Next">
							<span aria-hidden="true">&raquo;</span>
							<span class="sr-only">Next</span>
						</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
	{{ weekly_summary_plot_div|safe }}
</div></div>
	<h2>Week beginning {{ moment(current_week).format("LL") }}</h2>
	{% for day_detail in current_week_dataset %}
		<h5>{{ moment(day_detail.day.calendar_date).format("ddd LL") }}</h5>
		{% for activity in day_detail.activities %}
			{% include '_activity_summary.html' %}
		{% endfor %}
		{% for category_group in day_detail.exercises_by_category %}
			<div class="card {{ category_group.category.category_key }}_border_only mt-2">
				<div class="card-header {{ category_group.category.category_key }}">
					<h6 class="m-0 p-0">
						<a href="#{{category_group.category.category_key}}-{{day_detail.day.day_of_week}}" data-toggle="collapse" role="button">
							<i class="fa fa-chevron-down"></i>
							{{ category_group.exercise_count }} {{ category_group.category.category_name }} sets
						</a>
					</h6>
					
				</div>
				<div id="{{category_group.category.category_key}}-{{day_detail.day.day_of_week}}" class="card-body collapse">
					<table class="table table-sm table-hover">
						{% for exercise in category_group.exercises %}
							<tr>
								<td style="width: 40%">
									{% if exercise.scheduled_exercise %}
										<i class="fa fa-check-square-o"></i>
									{% endif %}
									{{ exercise.type.name }}
								</td>
								<td style="width: 20%">{{ moment(exercise.exercise_datetime).format("HH:mm:ss") }}</td>
								<td style="width: 20%">
									{% if exercise.type.measured_by == "reps" %}
										{{ exercise.reps }} reps
									{% elif exercise.type.measured_by == "seconds" %}
										{{ exercise.seconds }} secs
									{% endif %}
								</td>
								<td style="width: 20%">
									<a href="{{ url_for('edit_exercise', id=exercise.id, next='/weekly_activity/{year}/{week}'.format(year=current_year, week=current_week)) }}">
										<i class="fa fa-edit"></i> Edit
									</a>
								</td>
							</tr>
						{% endfor %}
					</table>
				</div>
			</div>
		{% endfor %}
	{% endfor %}
	<div><img src="/static/img/api_logo_cptblWith_strava_horiz_light.png" class="mt-5" /></div>
{% endblock %}